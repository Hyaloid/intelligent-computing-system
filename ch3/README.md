# 实验一、基于 VGG19 实现图像分类

## 1. 实验目的

   掌握卷积神经网络的设计原理，掌握卷积神经网络的使用方法，能够使用 Python 语言实现VGG19网络模型对给定的输入图像进行分类。

   具体包括：
    
>   a) 加深对深度卷积神经网络中卷积层、最大池化层等基本单元的理解。\
>   b) 利用Python语言实现VGG19的前向传播计算，加深对VGG19网络结构的理解，为后续风格迁移中使用 VGG19 网络计算风格损失奠定基础。\
>   c) 在第2.1节实验的基础上将三层神经网络扩展为 VGG19 网络，加深对神经网络工程 实现中基本模块演变的理解，为后续建立更复杂的综合实验(如风格迁移)奠定基础。

## 2. 实验环境

   硬件环境：CPU。

   软件环境：Python 编译环境及相关的扩展库，包括 Python 2.7.9，Pillow 3.4.2，SciPy 0.18.1，NumPy 1.11.2(本实验不需使用 TensorFlow 等深度学习框架)。

   数据集　：官方训练 VGG19 使用的数据集为 ImageNet。

>   该数据集包括约 128 万训练 图像和 5 万张验证图像，共有 1000 个不同的类别。本实验使用了官方训练好的模型参数，并不需要直接使用 ImageNet 数据集进行 VGG19 模型的训练。

## 3. 评分标准

   为验证实验的正确性，选择如图3.9所示猫咪的图像进行分类测试。

   该猫咪图像的真实 类别为 tabby cat，对应 ImageNet 数据集类别编号的 281。

   实验结果将该图像的类别编号判 断为 281。

   通过查询 ImageNet 数据集类别编号对应的具体类别，编号 281 对应 tabby cat，说明利用 VGG19 网络判断得到了正确的图像类别。


# 实验二、基于 DLP 平台实现图像分类


## 1. 实验目的

   巩固卷积神经网络的设计原理，能够使用 pycnml 库提供的 Python 接口将 VGG19 网络模型移植到 DLP 上，实现图像分类。

   具体包括：

> a) 使用 pycnml 库实现卷积、ReLU 等基本网络模块。\
> b) 使用提供的 pycnml 库实现 VGG19 网络。\
> c) 分析评估 DLP 和 CPU 运行 VGG19 进行图像分类的性能。

## 2. 实验环境

   硬件环境:DLP。

   软件环境:pycnml 库、Python 编译环境及相关的扩展库，包括 Python 2.7.12，Pillow3.4.2，Scipy 0.18.1，NumPy 1.11.2。 

   数据集:ImageNet。


## 3. 评分标准

   本实验仍然选择图3.9所示猫咪的图像进行分类测试，该猫咪图像的真实类别为 tabby cat，对应ImageNet数据集类别编号的281。

   若实验结果将该图像的类别编号判断为281，则 可认为判断正确。

   性能评判标准为预测猫咪类别时 VGG19 网络 forward 函数运行的时间。

# 实验三、非实时图像风格迁移

## 1. 实验目的

   掌握深度学习的训练方法，能够使用 Python 语言基于 VGG19 网络模型实现非实时图 像风格迁移。

   具体包括：
> a) 加深对卷积神经网络的理解，利用 VGG19 模型进行图像特征提取。\
> b) 使用 Python 语言实现风格迁移中相关风格和内容损失函数的计算，加深对非实时 风格迁移的理解。\
> c) 使用 Python 语言实现非实时风格迁移中迭代求解风格化图像的完整流程，为后续 实现实时风格迁移并建立更复杂的综合实验奠定基础。

## 2. 实验环境

   硬件环境: CPU。

   软件环境: Python 编译环境及相关的扩展库，包括 Python 2.7.9，Pillow 3.4.2，SciPy 0.18.1，NumPy 1.11.2(本实验不需使用 TensorFlow 等深度学习框架)。

## 3. 评分标准

* 60 分标准: \
          正确实现利用四重循环计算卷积层和池化层的前向传播和反向传播过程。\
          给定卷积层和最大池化层的前向传播和反向传播输入矩阵和参数值，可以得到正确的前向传播输出矩阵和反向传播输出梯度。\
          同时分别给出卷积层和最大池化层正确的前向传播和反向传播时间。 
* 80 分标准: \
          正确实现内容损失函数和风格损失函数的计算，计算得出风格迁移后的图片。\
          给定生成图像、目标内容图像和目标风格图像，可以计算得到正确的内容损失值和风格损失值；\
          可以得到正确的内容损失和风格损失对生成图像的更新梯度，生成风格迁移后的图像。 
* 100 分标准: \
          对第3.3节实验中介绍的卷积层和池化层的实现中使用的四重循环进行改进，提升计算速度。\
          给定卷积层和池化层的前向传播和反向传播输入矩阵和参数值，可以得到正确的前向传播输出矩阵和反向传播输出梯度。\
          同时分别给出卷积层和池化层正确的前向传播和反向传播时间和对应的加速比。
